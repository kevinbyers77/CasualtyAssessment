<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Casualty Assessment Report</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <header>
    <h1>Casualty Assessment Report</h1>
    <nav>
      <button id="btn-new">New Report</button>
      <button id="btn-saved">Saved Reports</button>
      <button id="btn-archived">Archived Reports</button>
    </nav>
    <span id="save-status"></span>
  </header>

  <main>
    <!-- =======================
         Form Section
    ======================= -->
    <section id="form-section">
      <form id="casualty-form">

        <!-- Patient Information -->
        <fieldset>
          <legend>Patient Information</legend>
          <div class="row">
            <label>Name <input type="text" id="patientName"></label>
            <label>DOB <input type="date" id="dob"></label>
            <label>Gender 
              <select id="gender">
                <option></option>
                <option>Male</option>
                <option>Female</option>
              </select>
            </label>
          </div>
          <div class="row">
            <label>Home Address <input type="text" id="homeAddress"></label>
            <label>Town <input type="text" id="town"></label>
            <label>State <input type="text" id="state"></label>
            <label>Postcode <input type="text" id="postcode"></label>
          </div>
          <div class="row">
            <label>Employee No <input type="text" id="employeeNo"></label>
            <label>Contractor <input type="text" id="contractor"></label>
            <label>Occupation <input type="text" id="occupation"></label>
            <label>Shift Start <input type="time" id="shiftStart"></label>
          </div>
        </fieldset>

        <!-- Injury Details -->
        <fieldset>
          <legend>Injury Details</legend>
          <div class="row">
            <label>Date <input type="date" id="injuryDate"></label>
            <label>Time <input type="time" id="injuryTime"></label>
            <label>Location <input type="text" id="injuryLocation"></label>
          </div>
        </fieldset>

        <!-- History -->
        <fieldset>
          <legend>History of Injury/Illness</legend>
          <label for="history" class="full-width">
            What job was being done? Environmental conditions? Who witnessed? How did the injury occur?
          </label>
          <textarea id="history"></textarea>
          <div class="row">
            <label>
              Recurring Injury?
              <span class="radio-group">
                <label><input type="radio" name="recurring" value="Yes"> Yes</label>
                <label><input type="radio" name="recurring" value="No"> No</label>
              </span>
            </label>
            <label id="recurringDateField" style="display:none;">Date of original injury
              <input type="date" id="recurringDate">
            </label>
          </div>
        </fieldset>

        <!-- Primary Assessment -->
        <fieldset>
          <legend>Primary Assessment</legend>
          <div class="row">
            <label>
              <span class="inline-input">
                <input type="checkbox" id="danger"> Danger
                <input type="text" id="dangerDetails" placeholder="Details">
              </span>
            </label>
            <label>Response 
              <select id="response">
                <option></option>
                <option>Conscious</option>
                <option>Semi-conscious</option>
                <option>Unconscious</option>
              </select>
            </label>
            <label>Airway 
              <select id="airway">
                <option></option>
                <option>Clear</option>
                <option>Obstructed</option>
                <option>Guedel</option>
              </select>
            </label>
            <label>Breathing 
              <select id="breathing">
                <option></option>
                <option>Normal</option>
                <option>Abnormal</option>
                <option>Absent</option>
              </select>
            </label>
            <label>Signs of Life 
              <select id="signsOfLife">
                <option></option>
                <option>Pink</option>
                <option>Pale</option>
                <option>Cyanosed</option>
              </select>
            </label>
          </div>
        </fieldset>

        <!-- Casualty Observations -->
        <fieldset>
          <legend>Casualty Observations</legend>
          <table id="observations-table">
            <thead>
              <tr>
                <th>Time</th><th>Pulse</th><th>BP</th><th>Breaths</th><th>GCS</th>
                <th>Pupil L</th><th>Pupil R</th><th>React L</th><th>React R</th><th>Action</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <button type="button" id="add-observation" class="btn-small">+ Add Observation</button>
        </fieldset>

        <!-- Secondary Assessment -->
        <fieldset>
          <legend>Secondary Assessment</legend>
          <div class="injury-diagrams">
            <div class="diagram" id="front-wrap">
              <canvas id="diagram-front" width="250" height="400"></canvas>
              <div class="diagram-controls"><button type="button" onclick="frontDiagram.undo()">Undo</button></div>
            </div>
            <div class="diagram" id="back-wrap">
              <canvas id="diagram-back" width="250" height="400"></canvas>
              <div class="diagram-controls"><button type="button" onclick="backDiagram.undo()">Undo</button></div>
            </div>
          </div>
          <p class="diagram-label"><strong>Injury Codes:</strong> A – Abrasion, L – Laceration, B – Bruise, P – Puncture, S – Swelling, O – Other, Am – Amputation, C – Crush, T – Tenderness, D – Deformity, E – Embedded</p>
        </fieldset>

        <!-- Signature -->
        <fieldset>
          <legend>Signature</legend>
          <canvas id="signature-pad" width="300" height="100"></canvas>
          <div class="button-row">
            <button type="button" id="clear-signature" class="btn-clear">Clear Signature</button>
          </div>
          <div class="row">
            <label>Signer Name <input type="text" id="signerName"></label>
          </div>
          <div class="button-row">
            <button type="submit" class="btn-edit">Save Report</button>
          </div>
        </fieldset>

      </form>
    </section>

    <!-- =======================
         Records Sections
    ======================= -->
    <section id="records-section" style="display:none;">
      <h2>Saved Reports</h2>
      <ul id="records-list"></ul>
    </section>

    <section id="archived-section" style="display:none;">
      <h2>Archived Reports</h2>
      <ul id="archived-list"></ul>
    </section>
  </main>

  <script src="script.js"></script>
</body>
</html>
