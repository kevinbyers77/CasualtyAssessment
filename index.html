<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Casualty Assessment</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script defer src="script.js"></script>
</head>
<body>
  <header>
    <h1>Casualty Assessment</h1>
    <nav>
      <button id="btn-new" onclick="showForm()">New Report</button>
      <button id="btn-saved" onclick="showRecords()">Saved Reports</button>
      <button id="btn-archived" onclick="showArchived()">Archived</button>
      <span id="save-status"></span>
    </nav>
  </header>

  <!-- FORM SECTION -->
  <section id="form-section" style="display:none;">
    <form id="casualty-form">

      <!-- Patient Details -->
      <fieldset>
        <legend>Patient Details</legend>
        <div class="row">
          <div class="field"><label>Name <input id="patientName"></label></div>
          <div class="field"><label>DOB <input type="date" id="dob"></label></div>
          <div class="field"><label>Gender 
            <select id="gender"><option></option><option>Male</option><option>Female</option><option>Other</option></select>
          </label></div>
        </div>
        <div class="row">
          <div class="field"><label>Home Address <input id="homeAddress"></label></div>
          <div class="field"><label>Town <input id="town"></label></div>
          <div class="field"><label>State <input id="state"></label></div>
          <div class="field"><label>Postcode <input id="postcode"></label></div>
        </div>
        <div class="row">
          <div class="field"><label>Employee No <input id="employeeNo"></label></div>
          <div class="field"><label>Contractor <input id="contractor"></label></div>
          <div class="field"><label>Occupation <input id="occupation"></label></div>
          <div class="field"><label>Shift Start <input type="time" id="shiftStart"></label></div>
        </div>
      </fieldset>

      <!-- Injury -->
      <fieldset>
        <legend>Injury</legend>
        <div class="row">
          <div class="field"><label>Date <input type="date" id="injuryDate"></label></div>
          <div class="field"><label>Time <input type="time" id="injuryTime"></label></div>
          <div class="field"><label>Location <input id="injuryLocation"></label></div>
        </div>
        <div class="row"><div class="field full"><label>History <textarea id="history"></textarea></label></div></div>
        <div class="row">
          <div class="field"><label>Recurring? 
            <input type="radio" name="recurring" value="Yes" onchange="toggleRecurring(true)"> Yes
            <input type="radio" name="recurring" value="No" checked onchange="toggleRecurring(false)"> No
          </label></div>
          <div class="field" id="recurringDateField" style="display:none;">
            <label>Original Date <input type="date" id="recurringDate"></label>
          </div>
        </div>
      </fieldset>

      <!-- Primary Survey -->
      <fieldset>
        <legend>Primary Survey</legend>
        <div class="row">
          <div class="field"><label><input type="checkbox" id="danger"> Danger</label></div>
          <div class="field"><label>Response <input id="response"></label></div>
          <div class="field"><label>Airway <input id="airway"></label></div>
          <div class="field"><label>Breathing <input id="breathing"></label></div>
          <div class="field"><label>Signs of Life <input id="signsOfLife"></label></div>
        </div>
      </fieldset>

      <!-- Observations -->
      <fieldset>
        <legend>Observations</legend>
        <table id="observations-table">
          <thead>
            <tr>
              <th>Time</th><th>Pulse</th><th>BP</th><th>Breaths</th>
              <th>GCS</th><th>Pupil L</th><th>Pupil R</th><th>React L</th><th>React R</th><th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <button type="button" onclick="addObservationRow()">Add Observation</button>
      </fieldset>

      <!-- Secondary Survey -->
      <fieldset>
        <legend>Secondary Survey</legend>
        <div class="row">
          <div id="injury-key">
            <strong>Injury Codes:</strong>
            <ul>
              <li>A - Abrasion</li><li>L - Laceration</li><li>B - Bruise</li>
              <li>P - Puncture</li><li>S - Swelling</li><li>O - Other</li>
              <li>Am - Amputation</li><li>C - Crush</li><li>T - Tenderness</li>
              <li>D - Deformity</li><li>E - Entry/Exit</li>
            </ul>
          </div>
          <div class="field">
            <div id="front-wrap">
              <canvas id="diagram-front" width="300" height="400"></canvas>
              <button type="button" onclick="frontDiagram.undo()">Undo</button>
            </div>
          </div>
          <div class="field">
            <div id="back-wrap">
              <canvas id="diagram-back" width="300" height="400"></canvas>
              <button type="button" onclick="backDiagram.undo()">Undo</button>
            </div>
          </div>
        </div>
      </fieldset>

      <!-- Questions -->
      <fieldset>
        <legend>Questions</legend>
        <div class="row">
          <div class="field"><label>Remember event? 
            <input type="radio" name="remember" value="Yes"> Yes 
            <input type="radio" name="remember" value="No"> No
          </label></div>
          <div class="field"><label>Where hurts most? <input id="hurtMost"></label></div>
          <div class="field"><label>Pain rating (0-10) <input type="number" id="painRating" min="0" max="10"></label></div>
          <div class="field"><label>Hurts to breathe deeply? 
            <input type="radio" name="deepBreath" value="Yes"> Yes 
            <input type="radio" name="deepBreath" value="No"> No
          </label></div>
        </div>
      </fieldset>

      <!-- Allergies / Illnesses / Meds -->
      <fieldset>
        <legend>Allergies / Illnesses / Meds</legend>
        <div class="row">
          <div class="field"><label>Allergies? 
            <input type="radio" name="allergies" value="Yes"> Yes 
            <input type="radio" name="allergies" value="No"> No
          </label></div>
          <div class="field full"><label>Details <input id="allergyDetails"></label></div>
        </div>
        <div class="row">
          <div class="field full"><label>Illnesses (select all)<br>
            <label><input type="checkbox" class="illness" value="Diabetes"> Diabetes</label>
            <label><input type="checkbox" class="illness" value="Asthma"> Asthma</label>
            <label><input type="checkbox" class="illness" value="Epilepsy"> Epilepsy</label>
            <label><input type="checkbox" class="illness" value="Heart"> Heart</label>
          </label></div>
        </div>
        <div class="row">
          <div class="field"><label>Regular Meds <input id="regularMeds"></label></div>
          <div class="field"><label>Meds Today <input id="todayMeds"></label></div>
        </div>
      </fieldset>

      <!-- Treatment -->
      <fieldset>
        <legend>Treatment</legend>
        <div class="row">
          <div class="field full"><label>Treatment Given <textarea id="treatment"></textarea></label></div>
        </div>
      </fieldset>

      <!-- Advanced Treatment -->
      <fieldset>
        <legend>Advanced Treatment</legend>
        <div class="row">
          <div class="field"><label><input type="checkbox" id="penthYes"> Penthrox Given</label></div>
          <div class="field"><label><input type="checkbox" id="penth3"> 3 min</label></div>
          <div class="field"><label><input type="checkbox" id="penth6"> 6 min</label></div>
          <div class="field"><label><input type="checkbox" id="penthNo"> None</label></div>
          <div class="field"><label>Dose 1 <input id="penthDose1"></label></div>
          <div class="field"><label>Dose 2 <input id="penthDose2"></label></div>
        </div>
        <div class="row">
          <div class="field"><label><input type="checkbox" id="oxygenYes"> Oxygen Given</label></div>
          <div class="field"><label><input type="checkbox" id="oxygen8"> 8L</label></div>
          <div class="field"><label><input type="checkbox" id="oxygen15"> 15L</label></div>
          <div class="field"><label><input type="checkbox" id="oxygen15Resus"> 15L Resus</label></div>
          <div class="field"><label><input type="checkbox" id="oxygenNo"> None</label></div>
        </div>
        <div class="row">
          <div class="field"><label><input type="checkbox" id="ventolinYes"> Ventolin Given</label></div>
          <div class="field"><label><input type="checkbox" id="ventolinNo"> None</label></div>
          <div class="field"><label>Time <input id="ventolinTime" type="time"></label></div>
        </div>
        <div class="row">
          <div class="field"><label>Hand Unit Time <input id="handUnitTime" type="time"></label></div>
          <div class="field"><label>Aero Time <input id="aeroTime" type="time"></label></div>
        </div>
        <div class="row">
          <div class="field"><label><input type="checkbox" id="evacReturn"> Return to Work</label></div>
          <div class="field"><label><input type="checkbox" id="evacGP"> GP</label></div>
          <div class="field"><label><input type="checkbox" id="evacHome"> Home</label></div>
          <div class="field"><label><input type="checkbox" id="evacAmb"> Ambulance</label></div>
          <div class="field"><label><input type="checkbox" id="evacHeli"> Helicopter</label></div>
        </div>
      </fieldset>

      <!-- Signature -->
      <fieldset>
        <legend>Signature</legend>
        <div class="row">
          <canvas id="signature-pad"></canvas>
          <div>
            <button type="button" id="clear-signature">Clear</button>
            <label>Name <input id="signerName"></label>
          </div>
        </div>
      </fieldset>

      <button type="submit">Save Report</button>
    </form>
  </section>

  <!-- RECORDS -->
  <section id="records-section" style="display:block;">
    <ul id="records-list"></ul>
  </section>

  <!-- ARCHIVED -->
  <section id="archived-section" style="display:none;">
    <ul id="archived-list"></ul>
  </section>
</body>
</html>
